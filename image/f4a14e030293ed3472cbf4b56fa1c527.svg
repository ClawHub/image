<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="488px" preserveAspectRatio="none" style="width:748px;height:488px;background:#FFFFFF;" version="1.1" viewBox="0 0 748 488" width="748px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="307.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="38" y="91.2969"/><rect fill="#FFFFFF" height="286.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="316" y="112.4297"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="506" y="141.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="506" y="324.3594"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="635" y="223.9609"/><rect fill="none" height="175.7969" style="stroke:#000000;stroke-width:1.5;" width="585" x="157.5" y="185.6953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="43" x2="43" y1="81.2969" y2="407.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="320.5" x2="320.5" y1="81.2969" y2="407.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="510.5" x2="510.5" y1="81.2969" y2="407.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="639.5" x2="639.5" y1="81.2969" y2="407.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="5" y="77.9951">方法调用者</text><ellipse cx="43" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,21.5 L43,48.5 M30,29.5 L56,29.5 M43,48.5 L30,63.5 M43,48.5 L56,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="5" y="419.6201">方法调用者</text><ellipse cx="43" cy="431.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,439.4219 L43,466.4219 M30,447.4219 L56,447.4219 M43,466.4219 L30,481.4219 M43,466.4219 L56,481.4219 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="307" x="167.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="293" x="174.5" y="69.9951">GoodsStockResidueCacheBizReadService</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="307" x="167.5" y="406.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="293" x="174.5" y="426.6201">GoodsStockResidueCacheBizReadService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="484.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="491.5" y="69.9951">Redis</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="484.5" y="406.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="491.5" y="426.6201">Redis</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="185" x="547.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171" x="554.5" y="69.9951">GoodsStockReadService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="185" x="547.5" y="406.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171" x="554.5" y="426.6201">GoodsStockReadService</text><rect fill="#FFFFFF" height="307.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="38" y="91.2969"/><rect fill="#FFFFFF" height="286.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="316" y="112.4297"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="506" y="141.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="506" y="324.3594"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="635" y="223.9609"/><polygon fill="#181818" points="304,108.4297,314,112.4297,304,116.4297,308,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="48" x2="310" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="55" y="107.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="68" y="107.3638">queryGoodsStockResidueFromCache</text><polygon fill="#181818" points="494,137.5625,504,141.5625,494,145.5625,498,141.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="326" x2="500" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="333" y="136.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="346" y="136.4966">get</text><polygon fill="#181818" points="337,166.6953,327,170.6953,337,174.6953,333,170.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="510" y1="170.6953" y2="170.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="343" y="165.6294">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="356" y="165.6294">缓存中的值</text><path d="M157.5,185.6953 L221.5,185.6953 L221.5,192.8281 L211.5,202.8281 L157.5,202.8281 L157.5,185.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="175.7969" style="stroke:#000000;stroke-width:1.5;" width="585" x="157.5" y="185.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="172.5" y="198.7622">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="146" x="236.5" y="197.9058">[如果缓存中数据不存在,加锁]</text><polygon fill="#181818" points="623,219.9609,633,223.9609,623,227.9609,627,223.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="326" x2="629" y1="223.9609" y2="223.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="333" y="218.895">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="346" y="218.895">queryBySpuId 查询goods_stock表数据</text><polygon fill="#181818" points="337,249.0938,327,253.0938,337,257.0938,333,253.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="639" y1="253.0938" y2="253.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="343" y="248.0278">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="356" y="248.0278">数据库中的值</text><line style="stroke:#181818;stroke-width:1.0;" x1="326" x2="368" y1="282.2266" y2="282.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="368" x2="368" y1="282.2266" y2="295.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="327" x2="368" y1="295.2266" y2="295.2266"/><polygon fill="#181818" points="337,291.2266,327,295.2266,337,299.2266,333,295.2266" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="333" y="277.1606">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="346" y="277.1606">准备剩余库存的值</text><polygon fill="#181818" points="494,320.3594,504,324.3594,494,328.3594,498,324.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="326" x2="500" y1="324.3594" y2="324.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="333" y="319.2935">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="346" y="319.2935">设置剩余库存</text><polygon fill="#181818" points="337,349.4922,327,353.4922,337,357.4922,333,353.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="331" x2="510" y1="353.4922" y2="353.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="343" y="348.4263">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="356" y="348.4263">结果</text><polygon fill="#181818" points="59,385.625,49,389.625,59,393.625,55,389.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53" x2="315" y1="389.625" y2="389.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="65" y="384.5591">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="78" y="384.5591">剩余库存</text></g></svg>