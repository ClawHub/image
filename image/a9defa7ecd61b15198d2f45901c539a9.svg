<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1104px" preserveAspectRatio="none" style="width:2623px;height:1104px;background:#FFFFFF;" version="1.1" viewBox="0 0 2623 1104" width="2623px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="922.9844" style="stroke:#181818;stroke-width:1.0;" width="10" x="26.5" y="91.2969"/><rect fill="#FFFFFF" height="901.8516" style="stroke:#181818;stroke-width:1.0;" width="10" x="182.5" y="112.4297"/><rect fill="#FFFFFF" height="834.5859" style="stroke:#181818;stroke-width:1.0;" width="10" x="435" y="141.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="874" y="212.8281"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="874" y="295.2266"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1135" y="401.7578"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1441" y="460.0234"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1441" y="860.75"/><rect fill="#FFFFFF" height="180.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1722" y="602.5547"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="2129" y="666.8203"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="2328" y="725.0859"/><rect fill="none" height="691.0547" style="stroke:#000000;stroke-width:1.5;" width="2340" x="277" y="256.9609"/><rect fill="none" height="601.6563" style="stroke:#000000;stroke-width:1.5;" width="2320" x="287" y="339.3594"/><rect fill="none" height="210.9297" style="stroke:#000000;stroke-width:1.5;" width="1291.5" x="307" y="363.4922"/><rect fill="none" height="106.5313" style="stroke:#000000;stroke-width:1.5;" width="1311.5" x="297" y="798.3516"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="1291.5" x="307" y="822.4844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="31" x2="31" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="187" x2="187" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="440" x2="440" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="878.5" x2="878.5" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1139.5" x2="1139.5" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1445.5" x2="1445.5" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1726.5" x2="1726.5" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2134" x2="2134" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2333" x2="2333" y1="81.2969" y2="1023.2813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2518" x2="2518" y1="81.2969" y2="1023.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="5" y="77.9951">Dubbo</text><ellipse cx="31.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M31.5,21.5 L31.5,48.5 M18.5,29.5 L44.5,29.5 M31.5,48.5 L18.5,63.5 M31.5,48.5 L44.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="5" y="1035.2764">Dubbo</text><ellipse cx="31.5" cy="1047.0781" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M31.5,1055.0781 L31.5,1082.0781 M18.5,1063.0781 L44.5,1063.0781 M31.5,1082.0781 L18.5,1097.0781 M31.5,1082.0781 L44.5,1097.0781 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="239" x="68" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225" x="75" y="69.9951">SpuOrderStockWriteBusinessApi</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="239" x="68" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225" x="75" y="1042.2764">SpuOrderStockWriteBusinessApi</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="246" x="317" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232" x="324" y="69.9951">SpuOrderStockLockWriteManager</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="246" x="317" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232" x="324" y="1042.2764">SpuOrderStockLockWriteManager</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="781.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="788.5" y="69.9951">GoodsSellLogReadService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="781.5" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="788.5" y="1042.2764">GoodsSellLogReadService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="307" x="986.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="293" x="993.5" y="69.9951">GoodsStockResidueCacheBizReadService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="307" x="986.5" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="293" x="993.5" y="1042.2764">GoodsStockResidueCacheBizReadService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="285" x="1303.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="1310.5" y="69.9951">GoodsStockResidueCacheWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="285" x="1303.5" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="1310.5" y="1042.2764">GoodsStockResidueCacheWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="257" x="1598.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1605.5" y="69.9951">SpuOrderStockLockBizWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="257" x="1598.5" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="1605.5" y="1042.2764">SpuOrderStockLockBizWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="184" x="2042" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="2049" y="69.9951">GoodsStockWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="184" x="2042" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="2049" y="1042.2764">GoodsStockWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="194" x="2236" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="180" x="2243" y="69.9951">GoodsSellLogWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="194" x="2236" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="180" x="2243" y="1042.2764">GoodsSellLogWriteService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="2440" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="2447" y="69.9951">TmSpuExportService</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="2440" y="1022.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="2447" y="1042.2764">TmSpuExportService</text><rect fill="#FFFFFF" height="922.9844" style="stroke:#181818;stroke-width:1.0;" width="10" x="26.5" y="91.2969"/><rect fill="#FFFFFF" height="901.8516" style="stroke:#181818;stroke-width:1.0;" width="10" x="182.5" y="112.4297"/><rect fill="#FFFFFF" height="834.5859" style="stroke:#181818;stroke-width:1.0;" width="10" x="435" y="141.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="874" y="212.8281"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="874" y="295.2266"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1135" y="401.7578"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1441" y="460.0234"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1441" y="860.75"/><rect fill="#FFFFFF" height="180.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1722" y="602.5547"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="2129" y="666.8203"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="2328" y="725.0859"/><polygon fill="#181818" points="170.5,108.4297,180.5,112.4297,170.5,116.4297,174.5,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36.5" x2="176.5" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="43.5" y="107.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="56.5" y="107.3638">lockStock</text><polygon fill="#181818" points="423,137.5625,433,141.5625,423,145.5625,427,141.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="192.5" x2="429" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="199.5" y="136.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="212.5" y="136.4966">lockStock</text><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="487" y1="170.6953" y2="170.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="487" x2="487" y1="170.6953" y2="183.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="446" x2="487" y1="183.6953" y2="183.6953"/><polygon fill="#181818" points="456,179.6953,446,183.6953,456,187.6953,452,183.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="452" y="165.6294">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="465" y="165.6294">校验参数：订单id、商品列表等</text><polygon fill="#181818" points="862,208.8281,872,212.8281,862,216.8281,866,212.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="868" y1="212.8281" y2="212.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="452" y="207.7622">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371" x="465" y="207.7622">queryListByOrderIdAndTypeList 查询当前订单的占用库存流水</text><polygon fill="#181818" points="456,237.9609,446,241.9609,456,245.9609,452,241.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="450" x2="878" y1="241.9609" y2="241.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="462" y="236.895">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="475" y="236.895">占用库存流水</text><path d="M277,256.9609 L341,256.9609 L341,264.0938 L331,274.0938 L277,274.0938 L277,256.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="691.0547" style="stroke:#000000;stroke-width:1.5;" width="2340" x="277" y="256.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="292" y="270.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="286" x="356" y="269.1714">[如果流水不存在，则加锁：spuOrderStock:orderId]</text><polygon fill="#181818" points="862,291.2266,872,295.2266,862,299.2266,866,295.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="868" y1="295.2266" y2="295.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="452" y="290.1606">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397" x="465" y="290.1606">queryListByOrderIdAndTypeList 再次查询当前订单的占用库存流水</text><polygon fill="#181818" points="456,320.3594,446,324.3594,456,328.3594,452,324.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="450" x2="878" y1="324.3594" y2="324.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="462" y="319.2935">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="475" y="319.2935">占用库存流水</text><path d="M287,339.3594 L351,339.3594 L351,346.4922 L341,356.4922 L287,356.4922 L287,339.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="601.6563" style="stroke:#000000;stroke-width:1.5;" width="2320" x="287" y="339.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="302" y="352.4263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="153" x="366" y="351.5698">[如果还是不存在占用库存流水]</text><path d="M307,363.4922 L384,363.4922 L384,370.625 L374,380.625 L307,380.625 L307,363.4922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="210.9297" style="stroke:#000000;stroke-width:1.5;" width="1291.5" x="307" y="363.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="322" y="376.5591">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120" x="399" y="375.7026">[循环订单中所有的商品]</text><polygon fill="#181818" points="1123,397.7578,1133,401.7578,1123,405.7578,1127,401.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="1129" y1="401.7578" y2="401.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="452" y="396.6919">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="465" y="396.6919">queryGoodsStockResidueFromCache</text><polygon fill="#181818" points="456,426.8906,446,430.8906,456,434.8906,452,430.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="450" x2="1139" y1="430.8906" y2="430.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="462" y="425.8247">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="475" y="425.8247">商品剩余库存</text><polygon fill="#181818" points="1429,456.0234,1439,460.0234,1429,464.0234,1433,460.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="1435" y1="460.0234" y2="460.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="452" y="454.9575">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="474" y="454.9575">扣减剩余库存</text><polygon fill="#181818" points="456,485.1563,446,489.1563,456,493.1563,452,489.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="450" x2="1445" y1="489.1563" y2="489.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="462" y="484.0903">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="484" y="484.0903">扣减后结果</text><path d="M450,502.1563 L450,527.1563 L1082,527.1563 L1082,512.1563 L1072,502.1563 L450,502.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1072,502.1563 L1072,512.1563 L1082,512.1563 L1072,502.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="611" x="456" y="519.2231">如果商品限制库存，且商品购买数量大于商品剩余库存数量，抛出异常：商品已售罄，请重新选择商品购买</text><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="487" y1="553.4219" y2="553.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="487" x2="487" y1="553.4219" y2="566.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="446" x2="487" y1="566.4219" y2="566.4219"/><polygon fill="#181818" points="456,562.4219,446,566.4219,456,570.4219,452,566.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="452" y="548.356">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="474" y="548.356">组装好数据，用于更新数据库</text><polygon fill="#181818" points="1710,598.5547,1720,602.5547,1710,606.5547,1714,602.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="1716" y1="602.5547" y2="602.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="452" y="597.4888">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="474" y="597.4888">锁库存</text><path d="M1737,615.5547 L1737,640.5547 L1810,640.5547 L1810,625.5547 L1800,615.5547 L1737,615.5547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1800,615.5547 L1800,625.5547 L1810,625.5547 L1800,615.5547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="1743" y="632.6216">开启事务</text><polygon fill="#181818" points="2117,662.8203,2127,666.8203,2117,670.8203,2121,666.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1732" x2="2123" y1="666.8203" y2="666.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1739" y="661.7544">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356" x="1761" y="661.7544">batchLockGoodsStock 批量更新goods_stock的剩余库存数</text><polygon fill="#181818" points="1743,691.9531,1733,695.9531,1743,699.9531,1739,695.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1737" x2="2133" y1="695.9531" y2="695.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1749" y="690.8872">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="1771" y="690.8872">更新结果</text><polygon fill="#181818" points="2316,721.0859,2326,725.0859,2316,729.0859,2320,725.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1732" x2="2322" y1="725.0859" y2="725.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1739" y="720.02">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="1761" y="720.02">batchInsertGoodsSellLog 批量插入占用库存流水</text><polygon fill="#181818" points="1743,750.2188,1733,754.2188,1743,758.2188,1739,754.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1737" x2="2332" y1="754.2188" y2="754.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1749" y="749.1528">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1771" y="749.1528">批量插入结果</text><polygon fill="#181818" points="456,779.3516,446,783.3516,456,787.3516,452,783.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="450" x2="1726" y1="783.3516" y2="783.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="462" y="778.2856">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="484" y="778.2856">结果</text><path d="M297,798.3516 L361,798.3516 L361,805.4844 L351,815.4844 L297,815.4844 L297,798.3516 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="106.5313" style="stroke:#000000;stroke-width:1.5;" width="1311.5" x="297" y="798.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="312" y="811.4185">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="76" x="376" y="810.562">[如果发生异常]</text><path d="M307,822.4844 L384,822.4844 L384,829.6172 L374,839.6172 L307,839.6172 L307,822.4844 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="1291.5" x="307" y="822.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="322" y="835.5513">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120" x="399" y="834.6948">[循环订单中所有的商品]</text><polygon fill="#181818" points="1429,856.75,1439,860.75,1429,864.75,1433,860.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="445" x2="1435" y1="860.75" y2="860.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="452" y="855.6841">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="474" y="855.6841">恢复扣减的剩余库存</text><polygon fill="#181818" points="456,885.8828,446,889.8828,456,893.8828,452,889.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="450" x2="1445" y1="889.8828" y2="889.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="462" y="884.8169">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="484" y="884.8169">结果</text><polygon fill="#181818" points="2506.5,929.0156,2516.5,933.0156,2506.5,937.0156,2510.5,933.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="445" x2="2512.5" y1="933.0156" y2="933.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="452" y="927.9497">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="474" y="927.9497">异步回写材料销售标志</text><polygon fill="#181818" points="203.5,972.1484,193.5,976.1484,203.5,980.1484,199.5,976.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="439" y1="976.1484" y2="976.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="209.5" y="971.0825">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="231.5" y="971.0825">锁定库存结果</text><polygon fill="#181818" points="47.5,1001.2813,37.5,1005.2813,47.5,1009.2813,43.5,1005.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="41.5" x2="181.5" y1="1005.2813" y2="1005.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="53.5" y="1000.2153">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="75.5" y="1000.2153"> </text></g></svg>